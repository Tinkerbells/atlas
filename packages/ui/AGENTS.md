# AGENTS: Правила для компонентов @atlas/ui

- **Структура**: каждый компонент в `src/<name>` с файлами `<name>.tsx` (или сборкой ark-ui-подкомпонентов), `<name>.module.css`, `<name>.stories.tsx`, `index.ts` (реэкспорт). Добавь экспорт в `src/index.ts`.
- **Логика (ориентир — park-ui)**: копируй паттерны из `park-ui/components/solid/src/components/ui/button.tsx` (splitProps/mergeProps, контексты для variant props, ark primitives и пр.), но исключи `styled-system/*` и их recipes — у нас только CSS-модули. Используй `ComponentProps`, `splitProps`, `mergeProps`, `Show`, `createMemo`, `cn` из `src/utils`, data-атрибуты для variant/size/state, дефолтный `type="button"` и т.п. Не тянем чужие дизайн-системы JS, только headless-слой ark-ui + своя логика.
- **Стили (Material Design 3)**: только `.module.css`, классы совпадают с именем компонента. Подключай M3 токены из `src/styles` (`--md-*`). Для базовых значений можно брать референсы из `mdui/packages/mdui/src/components/button/style.less` и `beercss/src/cdn/elements/buttons.css`; адаптируй под CSS Modules и наши токены. Состояния/варианты через `[data-variant]`, `[data-size]`, `:focus-visible`, `:disabled` и т.д. Без styled-system — чистый CSS.
- **Готовые M3 CSS-референсы**: для компонентов `avatar`, `badge`, `bottom-app-bar`, `button`, `button-icon`, `card`, `checkbox`, `chip`, `circular-progress`, `collapse`, `dialog`, `divider`, `dropdown`, `fab`, `icon`, `layout`, `linear-progress`, `list`, `menu`, `navigation-bar`, `navigation-drawer`, `navigation-rail`, `radio`, `range-slider`, `ripple`, `segmented-button`, `select`, `slider`, `snackbar`, `switch`, `tabs`, `text-field`, `tooltip`, `top-app-bar` и связанных подчастей (`*-item`, `*-group`, `*-main`, `*-title`, `tab-panel`) бери готовые стили из склонированных M3 библиотек (beercss/mdui) и адаптируй под module.css + наши токены.
- **Если компонента нет в списке**: всё равно следуем Material Design 3 токенам, но за основу компоновки/поведения можно взять рецепты из `park-ui/packages/preset/src/recipes/`, переписав стили в `.module.css`.
- **Storybook**: файл `<name>.stories.tsx` на `storybook-solidjs-vite` с `Meta`/`StoryObj`, `tags: ['autodocs']`, `parameters` (например `layout: 'centered'`), `argTypes` для всех публичных пропсов (варианты, размеры, состояния, кастомные слоты). Добавляй базовую историю (`Base`) с полным набором пропсов по умолчанию, затем отдельные истории для ключевых сценариев/состояний (default, link, disabled и т.д.) с JSDoc-комментариями-описаниями. В конце файла делай историю, показывающую все комбинации/вариации компонента в одном кадре (решетка/список). Документируй поведение и ограничения в описаниях историй/args.
- **Экспорт и токены**: не забывай про sideEffects для CSS (уже в package.json). Если компонент использует глобальные стили, убедись, что потребитель подтягивает `src/styles/index.css`.
- **Проверки**: после значимых изменений запускай из `packages/ui` — `pnpm lint`, `pnpm lint:fix` (при необходимости автофикс), `pnpm typecheck`. Не сдаём код без прохождения этих шагов.

## Material Design 3 — CSS правила (системный промпт в кратком виде)

- **Философия**: никаких хардкодов. Все цвета/отступы/формы через токены (`--md-ref-*` → `--md-sys-*` → компонентные). Используем пары роль/on-роль; поддержка светлой/тёмной темы через переопределения `--md-sys-*`.
- **Цвет**: primary/secondary контейнеры + on-\*; фоны `surface/background`; tint и state layers. Не темним фон напрямую — накладываем state layer.
- **Типографика**: типовые шкалы (Display/Headline/Title/Body/Label в Large/Medium/Small). Не хардкодим размеры в компонентах — используем заранее заданные типо-токены/утилиты (Roboto Flex, `font-variation-settings`).
- **Форма**: скругления по токенам `--md-sys-shape-*` (full для кнопок/переключателей, xl для Large FAB, medium для карт, extra-small для тултипов).
- **Высота и состояния**: elevation через `box-shadow` + surface tint `::before` (прозрачный primary слой по уровням 0.05–0.14). State layer для hover/focus/press/drag с opacity 8/12/12/16% цветом контента (`on-*`). В тёмной теме тени минимальны.
- **Макет/касание**: шаг 8px (4px для мелких). Touch target ≥48x48; увеличивай padding/прозрачные области если визуально меньше.
- **Порядок работы над компонентом**: определить семантические токены → геометрию/shape → цвета и роли → elevation + state layers → проверить адаптивность и темы.
