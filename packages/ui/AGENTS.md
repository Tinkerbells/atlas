# AGENTS: Правила для компонентов @atlas/ui

- **Структура**: каждый компонент в `src/<name>` с файлами `<name>.tsx` (или сборкой ark-ui-подкомпонентов), `<name>.module.css`, `<name>.stories.tsx`, `index.ts` (реэкспорт). Добавь экспорт в `src/index.ts`.
- **Логика (ориентир — park-ui)**: копируй паттерны из `park-ui/components/solid/src/components/ui/button.tsx` (splitProps/mergeProps, контексты для variant props, ark primitives и пр.), но исключи `styled-system/*` и их recipes — у нас только CSS-модули. Используй `ComponentProps`, `splitProps`, `mergeProps`, `Show`, `createMemo`, `cn` из `src/utils`, data-атрибуты для variant/size/state, дефолтный `type="button"` и т.п. Не тянем чужие дизайн-системы JS, только headless-слой ark-ui + своя логика.
- **Стили (material-web референс)**: пишем только `.module.css`, имя класса = имя компонента. За основу читаем Sass из `material-web/<component>`: базовая геометрия и состояния в `internal/_shared.scss` + `internal/shared-styles.scss`, вариантные токены/переменные в `internal/_*-<component>.scss`, сборочный вход `internal/*-styles.scss` просто `@include ...styles;`. Переноси структуру/значения в CSS Modules с нашими токенами `--md-*` из `src/styles`, сохраняй state layers, elevation, иконки и touch-target. Для подчастей компонента смотри соседние `internal/_icon.scss`, `_touch-target.scss`, `_elevation.scss` и т.п., адаптируй тем же способом.
- **Если компонента нет в material-web**: опирайся на паттерны существующих компонентов material-web (layout, state-layer, disabled), переносим их в `.module.css` и привязываем к нашим токенам `--md-*`.
- **Storybook**: файл `<name>.stories.tsx` на `storybook-solidjs-vite` с `Meta`/`StoryObj`, `tags: ['autodocs']`, `parameters` (например `layout: 'centered'`), `argTypes` для всех публичных пропсов (варианты, размеры, состояния, кастомные слоты). Добавляй базовую историю (`Base`) с полным набором пропсов по умолчанию, затем отдельные истории для ключевых сценариев/состояний (default, link, disabled и т.д.) с JSDoc-комментариями-описаниями. В конце файла делай историю, показывающую все комбинации/вариации компонента в одном кадре (решетка/список). Документируй поведение и ограничения в описаниях историй/args.
- **Экспорт и токены**: не забывай про sideEffects для CSS (уже в package.json). Если компонент использует глобальные стили, убедись, что потребитель подтягивает `src/styles/index.css`.
- **Проверки**: после значимых изменений запускай из `packages/ui` — `pnpm lint`, `pnpm lint:fix` (при необходимости автофикс), `pnpm typecheck`. Не сдаём код без прохождения этих шагов.

## Material Design 3 — CSS правила (системный промпт в кратком виде)

- **Философия**: никаких хардкодов. Все цвета/отступы/формы через токены (`--md-ref-*` → `--md-sys-*` → компонентные). Используем пары роль/on-роль; поддержка светлой/тёмной темы через переопределения `--md-sys-*`.
- **Цвет**: primary/secondary контейнеры + on-\*; фоны `surface/background`; tint и state layers. Не темним фон напрямую — накладываем state layer.
- **Типографика**: типовые шкалы (Display/Headline/Title/Body/Label в Large/Medium/Small). Не хардкодим размеры в компонентах — используем заранее заданные типо-токены/утилиты (Roboto Flex, `font-variation-settings`).
- **Форма**: скругления по токенам `--md-sys-shape-*` (full для кнопок/переключателей, xl для Large FAB, medium для карт, extra-small для тултипов).
- **Высота и состояния**: elevation через `box-shadow` + surface tint `::before` (прозрачный primary слой по уровням 0.05–0.14). State layer для hover/focus/press/drag с opacity 8/12/12/16% цветом контента (`on-*`). В тёмной теме тени минимальны.
- **Макет/касание**: шаг 8px (4px для мелких). Touch target ≥48x48; увеличивай padding/прозрачные области если визуально меньше.
- **Порядок работы над компонентом**: определить семантические токены → геометрию/shape → цвета и роли → elevation + state layers → проверить адаптивность и темы.
